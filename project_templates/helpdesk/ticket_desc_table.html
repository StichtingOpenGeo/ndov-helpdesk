{% load i18n %}
<h2>{{ ticket.id }}. {{ ticket.title }}&nbsp;<span class="label label-info">{{ ticket.get_status }}</span></h2> 
<div class='btn-group'>
    {% if helpdesk_settings.HELPDESK_SHOW_EDIT_BUTTON_TICKET_TOP %}
        <a href='{% url helpdesk_edit ticket.id %}' class="btn ticket-edit">{% trans "Edit" %}</a>
    {% endif %}
    {% if helpdesk_settings.HELPDESK_SHOW_DELETE_BUTTON_TICKET_TOP %}
	    <a href='{% url helpdesk_delete ticket.id %}' class="btn ticket-delete">{% trans "Delete" %}</a>
    {% endif %}
    {% if helpdesk_settings.HELPDESK_SHOW_HOLD_BUTTON_TICKET_TOP %}
    	{% if ticket.on_hold %}<a href='unhold/' class="btn ticket-hold">{% trans "Unhold" %}</a>{% else %}<a href='hold/' class="btn ticket-hold">{% trans "Hold" %}</a>{% endif %}
    {% endif %}
</div>

<table class="table table-striped table-condensed">
	<tr><th class="span4">{% trans "Queue" %}</th>
	<td>{{ ticket.queue }}</td></tr>	
	
	<tr><th>{% trans "Submitted On" %}</th>
	<td>{{ ticket.created|date:"r" }} ({{ ticket.created|timesince }} {% trans "ago" %})</td></tr>
	
	<tr><th>{% trans "Assigned To" %}</th>
	<td>{{ ticket.get_assigned_to }}{% ifequal ticket.get_assigned_to _('Unassigned') %} <a class="btn btn-mini" href='?take'>{% trans "Take" %}</a>{% endifequal %}</td></tr>
	
	<tr><th>{% trans "Submitter E-Mail" %}</th>
    <td>{{ ticket.submitter_email }}{% if user.is_superuser %} <a class="btn btn-mini" href='{% url helpdesk_email_ignore_add %}?email={{ ticket.submitter_email }}'>{% trans "Ignore" %}</a></strong>{% endif %}</td></tr>
    
    <tr><th>{% trans "Priority" %}</th>
    <td>{{ ticket.get_priority_display }}</td></tr>
    
    <tr><th>{% trans "Copies To" %}</th>
    <td>{% for ticketcc in ticket.ticketcc_set.all %}{{ ticketcc.display }}{% if not forloop.last %}, {% endif %}{% endfor %} <strong><a class='tooltip' href='{% url helpdesk_ticket_cc ticket.id %}'>{% trans "Manage" %}<span>{% trans "Click here to add / remove people who should receive an e-mail whenever this ticket is updated." %}</span></a></strong></td></tr>

{% if tags_enabled %}    
	<tr><th>{% trans "Tags" %}</th>
    <td>{{ ticket.tags }}</td></tr>
{% endif %}

	<tr>
	    <th>{% trans "Dependencies" %}</th>
	    <td>{% for dep in ticket.ticketdependency.all %}
	        {% if forloop.first %}<p>{% trans "This ticket cannot be resolved until the following ticket(s) are resolved" %}</p><ul>{% endif %}
	            <li><a href='{{ dep.depends_on.get_absolute_url }}'>{{ dep.depends_on.ticket }} {{ dep.depends_on.title }}</a> ({{ dep.depends_on.get_status_display }}) <a href='{% url helpdesk_ticket_dependency_del ticket.id dep.id %}'>{% trans "Remove Dependency" %}</a></li>
	        {% if forloop.last %}</ul>{% endif %}
	        {% empty %}
	        <p>{% trans "This ticket has no dependencies." %}</p>
	        {% endfor %}
	        <p><a class='tooltip' href='{% url helpdesk_ticket_dependency_add ticket.id %}'>{% trans "Add Dependency" %}<span>{% trans "Click on 'Add Dependency', if you want to make this ticket dependent on another ticket. A ticket may not be closed until all tickets it depends on are closed." %}</span></a></p>
	    </td>
	</tr>

	{% for customfield in ticket.ticketcustomfieldvalue_set.all %}
	<tr >
	    <th>{{ customfield.field.label }}</th>
	    <td>{% ifequal customfield.field.data_type "url" %}<a href='{{ customfield.value }}'>{{ customfield.value }}</a>{% else %}{{ customfield.value }}{% endifequal %}</td>
	</tr>
	{% endfor %}
  
</table>

<h3>{% trans "Description" %}</h3>
<div>{{ ticket.description|force_escape|urlizetrunc:50|linebreaksbr }}</div>

<br />
{% if ticket.resolution %}
	<h3>{% trans "Resolution" %}</h3> 
	{% ifequal ticket.get_status_display "Resolved" %} <a class="btn btn-primary" href='?close'>{<img src='{{ STATIC_URL }}helpdesk/buttons/accept.png' alt='{% trans "Accept" %}'>{% trans "Accept and Close" %}</a>{% endifequal %}
	<div>{{ ticket.resolution|force_escape|urlizetrunc:50|linebreaksbr }}</div>
	<br />
{% endif %}

